<!doctype html><html lang=en><head><title>my first week with gcp ::
always up, always on</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This blog article is my first one related to GCP (Google Cloud Platform). I just started as Cloud Customer Engineer at Google this week. So here are some learnings I would like to write down and share.
The onboarding process is really inspiring and well structured, driven by the collaboration and a learning experience led by practicing. Among different trainings and tools received, I got a great experience with G Suite and my Pixelbook, that&amp;rsquo;s concretely my very first time with them."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://mathieu-benoit.github.io/myblog.io/posts/2020/07/first-week-with-gcp/><link rel=stylesheet href=https://mathieu-benoit.github.io/myblog.io/assets/style.css><link rel=stylesheet href=https://mathieu-benoit.github.io/myblog.io/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://mathieu-benoit.github.io/myblog.io/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://mathieu-benoit.github.io/myblog.io/img/favicon.png><link href=https://mathieu-benoit.github.io/myblog.io/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://mathieu-benoit.github.io/myblog.io/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://mathieu-benoit.github.io/myblog.io/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://mathieu-benoit.github.io/myblog.io/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://mathieu-benoit.github.io/myblog.io/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://mathieu-benoit.github.io/myblog.io/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="my first week with gcp"><meta name=twitter:description content="let's share some learnings during my first week leveraging gcp, tools and services like linux on my pixelbook, gcloud cli, docker, git, service account, gcr, cloud run, app engine and kubernetes engine"><meta property="og:title" content="my first week with gcp"><meta property="og:description" content="let's share some learnings during my first week leveraging gcp, tools and services like linux on my pixelbook, gcloud cli, docker, git, service account, gcr, cloud run, app engine and kubernetes engine"><meta property="og:type" content="article"><meta property="og:url" content="https://mathieu-benoit.github.io/myblog.io/posts/2020/07/first-week-with-gcp/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-07-24T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-24T00:00:00+00:00"><meta property="og:site_name" content="always up, always on"><script async src="https://www.googletagmanager.com/gtag/js?id=G-J8536XT21V"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-J8536XT21V",{anonymize_ip:!1})}</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>always up, always on</span>
<span class=logo__cursor></span></a>
<span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/myblog.io/about/>about</a></li><li><a href=/myblog.io/presentations/>presentations</a></li><li><a href=/myblog.io/tags/>tags</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/myblog.io/about/>about</a></li><li><a href=/myblog.io/presentations/>presentations</a></li><li><a href=/myblog.io/tags/>tags</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>my first week with gcp</h1><div class=post-meta><span class=post-date>2020-07-24</span></div><span class=post-tags><a href=https://mathieu-benoit.github.io/myblog.io/tags/gcp/>#gcp</a>&nbsp;
<a href=https://mathieu-benoit.github.io/myblog.io/tags/containers/>#containers</a>&nbsp;
<a href=https://mathieu-benoit.github.io/myblog.io/tags/kubernetes/>#kubernetes</a>&nbsp;</span><div class=post-content><p>This blog article is my first one related to GCP (Google Cloud Platform). <a href=https://www.linkedin.com/posts/mathieubenoitqc_cloud-innovation-continuouslearning-activity-6685996290330947584-bKkB>I just started as Cloud Customer Engineer at Google</a> this week. So here are some learnings I would like to write down and share.</p><p>The onboarding process is really inspiring and well structured, driven by the collaboration and a learning experience led by practicing. Among different trainings and tools received, I got a great experience with G Suite and my Pixelbook, that&rsquo;s concretely my very first time with them. Really impressive productivity!</p><blockquote><p>Simplicity, Security.</p></blockquote><p>One setup on my Pixelbook I have done, is enabling the Linux feature on it. And from there, I was able to install tools I need locally: Docker, Kubernetes, Terraform, Slack, VS Code with the Cloud Code extension, etc.
You could find more details about this setup with this blog article: <a href=https://cloud.google.com/blog/products/application-development/build-a-dev-workflow-with-cloud-code-on-a-pixelbook>Build a dev workflow with Cloud Code on a Pixelbook</a>.</p><p>Among different internal trainings I&rsquo;m having related to my role, I also took the opportunity to learn more about GCP (for the very first time too), by practicing. I indeed needed to run few CLI commands! ;)</p><p>To accomplish this I took the <a href=https://google.qwiklabs.com/quests/23>Google Cloud Essentials course on Qwiklabs</a>:</p><ul><li><a href=https://cloud.google.com/compute/docs>Compute Engine</a>: Linux and Windows<ul><li>Impressive to see how fast it is to provision a VM!</li></ul></li><li><a href=https://cloud.google.com/shell/docs>Cloud Shell</a><ul><li>Love the very productive <code>gcloud beta interactive</code> command!</li></ul></li><li><a href=https://cloud.google.com/kubernetes-engine/docs>Kubernetes Engine</a><ul><li>Interestingly, one GKE cluster comes with <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repair>Node auto-repair</a> and <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-upgrades>Node auto-upgrade</a> by default.</li></ul></li><li><a href=https://cloud.google.com/load-balancing/docs>Load Balancers</a><ul><li><a href=https://cloud.google.com/load-balancing/docs/load-balancing-overview#a_closer_look_at_cloud_load_balancers>This doc</a> is a great resource to see your different options about Load Balancer on GCP.</li></ul></li></ul><p>The experience with <a href=https://google.qwiklabs.com>Qwiklabs</a> is awesome! I got step-by-step labs allowing me to do hands-on via the Google Cloud Console and via the Google Cloud Shell. Furthermore, the last exercise is a challenge, not step-by-step guided, making sure I&rsquo;m able to do it by myself!</p><p>Here are few general resources I have captured to keep as references:</p><ul><li><a href=https://cloud.withgoogle.com/next>Google Cloud Next OnAir 2020</a><ul><li>Here is very detailed description of this event: <a href=https://gregsramblings.com/blog/google-cloud-next-onair-cheat-sheet/>The Google Cloud Next OnAir Cheat Sheet</a></li></ul></li><li><a href=https://cloud.google.com/blog/>GCP Blog</a></li><li><a href=https://cloud.google.com/docs>GCP Docs</a></li><li><a href=https://cloud.google.com/pricing>GCP Pricing</a></li><li><a href=https://cloud.google.com/certification>GCP Certifications</a></li><li><a href=https://cloud.google.com/about/locations>GCP Locations</a></li><li><a href=https://cloud.google.com/compute/docs/regions-zones>Regions and Zones</a></li><li><a href=https://cloud.google.com/sdk/gcloud>GCP CLI</a><ul><li><a href=https://cloud.google.com/sdk/docs/cheatsheet>Here is the <code>gcloud</code> CLI cheat-sheet</a></li></ul></li></ul><p>Well, that&rsquo;s really cool, but now let&rsquo;s take one of <a href=https://mathieu-benoit.github.io/myblog.io/posts/2020/05/myblog/>my containerized app: <code>myblog</code></a> and delpoy it on GCP! For that we will leverage 4 services in GCP:</p><ul><li><a href=https://cloud.google.com/artifact-registry>Google Artifact Registry</a></li><li><a href=https://cloud.google.com/run>Google Cloud Run</a>, yep <a href=https://medium.com/google-cloud/can-cloud-run-handle-these-9-workloads-serverless-toolbox-afddeab87819>Cloud Run could run website too</a>! ;)</li><li><a href=https://cloud.google.com/appengine>Google Cloud App Engine</a></li><li><a href=https://cloud.google.com/kubernetes-engine>Google Kubernetes Engine</a></li></ul><p>I&rsquo;m running all the commands below since I have installed locally, like explained above, the <code>gcloud</code>, <code>Docker</code> and <code>kubectl</code> CLIs. But you could also do this from within the Google Cloud Shell which has already the three of them installed too (yep, with a Docker daemon too to succesfully run all your <code>docker</code> commands ;)).</p><pre tabindex=0><code># Clone the Git repo locally
git clone https://github.com/mathieu-benoit/myblog
git submodule init
git submodule update
cd myblog

# Setup the Project
gcloud init
gcloud config list
gcloud auth list
projectId=FIXME
projectName=FIXME
folderId=FIXME
gcloud projects create $projectId \
    --folder $folderId \
    --name $projectName
gcloud config set project $projectId
gcloud beta billing accounts list
billingAccountId=FIXME
gcloud beta billing projects link $projectId \
    --billing-account $billingAccountId

# Build and Push the Container in GCR
gcloud services enable artifactregistry.googleapis.com
location=us-east4
registryName=containers
gcloud artifacts repositories create $registryName \
    --location $location \
    --repository-format docker
registryHostName=$location-docker.pkg.dev
gcloud auth configure-docker $registryHostName --quiet
imageName=$registryHostName/$projectId/$registryName/myblog:1
docker build -t $imageName .
docker push $imageName

# Check the image pushed
gcloud artifacts docker images list $imageName
</code></pre><p>From here, we could now deploy this container from Artifact Registry to any services capable of hosting a container and which has access to pull the image. By default, any GCP service in the GCR&rsquo;s Project, has the proper access to do this. Now let&rsquo;s deploy this container image in three different services: Cloud Run, App Engine and Kubernetes Engine.</p><pre tabindex=0><code># Deploy this container on Cloud Run (&lt; 1min)
gcloud services enable run.googleapis.com
gcloud run deploy myblog \
    --image $imageName \
    --region us-east1 \
    --platform managed \
    --allow-unauthenticated

# Deploy this container on Google App Engine (~ 5min)
gcloud services enable appengineflex.googleapis.com
echo &#34;runtime: custom&#34; &gt;&gt; app.yaml
echo &#34;env: flex&#34; &gt;&gt; app.yaml
gcloud app deploy \
    --image-url $imageName

# Deploy this container on GKE (~ 5min)
gcloud services enable container.googleapis.com
clusterName=mygkecluster
zone=us-east1-b
gcloud container clusters create $clusterName \
    --zone $zone
gcloud container clusters get-credentials $clusterName \
    --zone $zone
kubectl run myblog \
    --image=$imageName \
    --generator=run-pod/v1
kubectl expose pod myblog \
    --type=LoadBalancer \
    --port=8080 \
    --target-port=8080
</code></pre><p>What a first week, really exciting! More learnings and blog articles related to GCP to come for sure! Stay tuned, cheers! ;)</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://mathieu-benoit.github.io/myblog.io/posts/2020/08/second-week-with-gcp/><span class=button__icon>←</span>
<span class=button__text>my second week with gcp</span></a></span>
<span class="button next"><a href=https://mathieu-benoit.github.io/myblog.io/posts/2020/07/coaching/><span class=button__text>the coaching habit</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>always up, always on</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2023 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script src=https://mathieu-benoit.github.io/myblog.io/assets/main.js></script>
<script src=https://mathieu-benoit.github.io/myblog.io/assets/prism.js></script></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-J8536XT21V"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-J8536XT21V",{anonymize_ip:!1})}</script></body></html>